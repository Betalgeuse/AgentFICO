# AgentFICO - Milestone M1: Smart Contract ë°°í¬

## âœ… Unblocked Notice
> **M2 ì™„ë£Œë¡œ ì´ ë§ˆì¼ìŠ¤í†¤ ì¬ê°œ ê°€ëŠ¥í•©ë‹ˆë‹¤.**
> 
> ì™„ë£Œ ì¡°ê±´:
> - âœ… ì ìˆ˜ ê³µì‹ í™•ì • (ADR-003)
> - âœ… ë°±í…ŒìŠ¤íŠ¸ í†µê³¼ (ì •í™•ë„ 75%, ëª©í‘œ 70%+ ì´ˆê³¼)
> - âœ… APIë¡œ ì ìˆ˜ ì¡°íšŒ ê°€ëŠ¥
> 
> ì°¸ì¡°: [ADR-002](../../adr/ADR-002-deployment-order.md), [ADR-003](../../adr/ADR-003-score-formula.md)

## Current Progress (2026-01-29)
- [x] M1-001: Foundry í”„ë¡œì íŠ¸ ì„¸íŒ…
- [x] M1-002: AgentFICOScore.sol êµ¬í˜„
- [x] M1-003: ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ (46ê°œ í†µê³¼)
- [x] M1-004: ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±
- [ ] M1-005: Base Sepolia ë°°í¬
- [ ] M1-006: Base Mainnet ë°°í¬
- [ ] M1-007: ë°°í¬ ë¬¸ì„œí™”

## Overview
| Field | Value |
|:---|:---|
| **Milestone ID** | M1-smart-contract-deployment |
| **Title** | Smart Contract ë°°í¬ (Foundry + Base) |
| **Status** | ğŸŸ¢ Ready |
| **Start Date** | 2026-01-29 |
| **Target Date** | 2026-01-31 |
| **Linear Label** | `milestone:M1` |
| **Linear Team** | `web3` |

## Goals
- Foundry í”„ë¡œì íŠ¸ ì„¸íŒ…
- AgentFICOScore.sol ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ êµ¬í˜„
- Base Sepolia í…ŒìŠ¤íŠ¸ë„· ë°°í¬ ë° í…ŒìŠ¤íŠ¸
- Base Mainnet ë°°í¬
- Basescan ì»¨íŠ¸ë™íŠ¸ ê²€ì¦

## Non-Goals
- REST API êµ¬í˜„ (M2)
- DeFi í”„ë¡œí† ì½œ í†µí•© (M3)
- í”„ë¡ íŠ¸ì—”ë“œ ëŒ€ì‹œë³´ë“œ (M4)
- ERC-8004 ì—°ë™ (í‘œì¤€ í™•ì • í›„)

## Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AgentFICO Smart Contract                     â”‚
â”‚                                                                 â”‚
â”‚  Network: Base (Coinbase L2)                                   â”‚
â”‚  - Mainnet: Chain ID 8453                                      â”‚
â”‚  - Sepolia: Chain ID 84532                                     â”‚
â”‚                                                                 â”‚
â”‚  RPC Endpoints:                                                â”‚
â”‚  - Mainnet: https://mainnet.base.org                           â”‚
â”‚  - Sepolia: https://sepolia.base.org                           â”‚
â”‚                                                                 â”‚
â”‚  Explorer:                                                      â”‚
â”‚  - Mainnet: https://basescan.org                               â”‚
â”‚  - Sepolia: https://sepolia.basescan.org                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AgentFICOScore.sol                           â”‚
â”‚  â”œâ”€â”€ updateScore(agent, scores)  - ì ìˆ˜ ì—…ë°ì´íŠ¸ (owner only)  â”‚
â”‚  â”œâ”€â”€ getScore(agent)             - ì ìˆ˜ ì¡°íšŒ (view)            â”‚
â”‚  â”œâ”€â”€ getScoreOnly(agent)         - ì¢…í•©ì ìˆ˜ë§Œ ì¡°íšŒ (gas ìµœì í™”)â”‚
â”‚  â”œâ”€â”€ assessRisk(agent, amount)   - ë¦¬ìŠ¤í¬ í‰ê°€ (view)          â”‚
â”‚  â””â”€â”€ getScoreHistory(agent)      - ì ìˆ˜ ì´ë ¥ ì¡°íšŒ              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Phase 0: Linear ì´ìŠˆ ë“±ë¡

### TASK-000: Linear í”„ë¡œì íŠ¸ ì´ˆê¸°í™”
```yaml
task_id: M1-000
title: "Linear ì´ìŠˆ ë“±ë¡"
droid: linear-project-manager
priority: critical
depends_on: []
team: web3

instructions: |
  1. Linear web3 íŒ€ì— ì´ìŠˆ ë“±ë¡
  2. Label ìƒì„±:
     - milestone:M1
     - phase:0, phase:1, phase:2, phase:3
     - type:contract, type:test, type:deploy
  3. ëª¨ë“  TASKë¥¼ Linear Issueë¡œ ë“±ë¡
  4. ì˜ì¡´ì„± ì„¤ì •

deliverables:
  - Linearì— ëª¨ë“  ì´ìŠˆ ë“±ë¡ ì™„ë£Œ
  - ê° TASKì— linear_issue_id ì¶”ê°€
```

## Phase 1: Foundry í”„ë¡œì íŠ¸ ì„¤ì •

### TASK-001: Foundry í”„ë¡œì íŠ¸ ì´ˆê¸°í™”
```yaml
task_id: M1-001
title: "Foundry í”„ë¡œì íŠ¸ ì„¸íŒ…"
droid: web3-smart-contract-auditor
priority: critical
depends_on: []

instructions: |
  ## ëª©í‘œ
  Foundry ê¸°ë°˜ ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ ê°œë°œ í™˜ê²½ êµ¬ì¶•
  
  ## ì„¤ì¹˜ ë° ì´ˆê¸°í™”
  1. forge init contracts
  2. OpenZeppelin ì˜ì¡´ì„± ì„¤ì¹˜
  3. foundry.toml ì„¤ì • (Base ë„¤íŠ¸ì›Œí¬)
  4. remappings.txt ì„¤ì •
  
  ## Base ë„¤íŠ¸ì›Œí¬ ì„¤ì •
  - Mainnet RPC: https://mainnet.base.org
  - Sepolia RPC: https://sepolia.base.org
  - Chain ID Mainnet: 8453
  - Chain ID Sepolia: 84532
  
  ## ë””ë ‰í† ë¦¬ êµ¬ì¡°
  contracts/
  â”œâ”€â”€ src/
  â”‚   â””â”€â”€ AgentFICOScore.sol
  â”œâ”€â”€ test/
  â”‚   â””â”€â”€ AgentFICOScore.t.sol
  â”œâ”€â”€ script/
  â”‚   â””â”€â”€ Deploy.s.sol
  â”œâ”€â”€ foundry.toml
  â””â”€â”€ .env.example

deliverables:
  - contracts/ ë””ë ‰í† ë¦¬ êµ¬ì¡°
  - foundry.toml (Base ë„¤íŠ¸ì›Œí¬ ì„¤ì • í¬í•¨)
  - .env.example

acceptance_criteria:
  - [ ] forge build ì„±ê³µ
  - [ ] forge test ì‹¤í–‰ ê°€ëŠ¥
```

### TASK-002: AgentFICOScore.sol êµ¬í˜„
```yaml
task_id: M1-002
title: "AgentFICOScore í•µì‹¬ ê³„ì•½"
droid: web3-smart-contract-auditor
priority: critical
depends_on: [M1-001]

instructions: |
  ## ëª©í‘œ
  techspec ê¸°ë°˜ AgentFICOScore ì»¨íŠ¸ë™íŠ¸ êµ¬í˜„
  
  ## í•µì‹¬ êµ¬ì¡°ì²´
  1. Score êµ¬ì¡°ì²´
     - overall (0-1000)
     - txSuccess (40% weight)
     - x402Profitability (40% weight)  
     - erc8004Stability (20% weight)
     - confidence, riskLevel, timestamp, ipfsBreakdown
  
  2. RiskAssessment êµ¬ì¡°ì²´
     - riskLevel, defaultProbability, expectedLoss
     - positiveFactors, riskFactors
  
  ## í•µì‹¬ í•¨ìˆ˜
  1. updateScore() - ownerë§Œ í˜¸ì¶œ ê°€ëŠ¥
  2. getScore() - ì „ì²´ Score ë°˜í™˜
  3. getScoreOnly() - overallë§Œ ë°˜í™˜ (ê°€ìŠ¤ ìµœì í™”)
  4. assessRisk() - ë¦¬ìŠ¤í¬ í‰ê°€
  5. getScoreHistory() - ì´ë ¥ ì¡°íšŒ
  
  ## ë³´ì•ˆ ìš”êµ¬ì‚¬í•­
  - onlyOwner modifier
  - ì…ë ¥ê°’ ê²€ì¦ (0-100 ë²”ìœ„)
  - ì´ë²¤íŠ¸ ë°œí–‰

deliverables:
  - contracts/src/AgentFICOScore.sol

acceptance_criteria:
  - [ ] ëª¨ë“  í•¨ìˆ˜ êµ¬í˜„
  - [ ] ë³´ì•ˆ modifier ì ìš©
  - [ ] NatSpec ë¬¸ì„œí™”
  - [ ] forge build ì„±ê³µ
```

### TASK-003: AgentFICOScore í…ŒìŠ¤íŠ¸
```yaml
task_id: M1-003
title: "AgentFICOScore ë‹¨ìœ„ í…ŒìŠ¤íŠ¸"
droid: web3-smart-contract-auditor
priority: high
depends_on: [M1-002]

instructions: |
  ## í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤
  1. ì ìˆ˜ ì—…ë°ì´íŠ¸ í…ŒìŠ¤íŠ¸
     - ì •ìƒ ì—…ë°ì´íŠ¸
     - owner ì•„ë‹Œ ì£¼ì†Œì—ì„œ í˜¸ì¶œ ì‹œ revert
     - ì˜ëª»ëœ ì ìˆ˜ ë²”ìœ„ (>100) revert
  
  2. ì ìˆ˜ ì¡°íšŒ í…ŒìŠ¤íŠ¸
     - getScore() ì •ìƒ ë°˜í™˜
     - getScoreOnly() ê°€ìŠ¤ íš¨ìœ¨ í™•ì¸
     - ë¯¸ë“±ë¡ ì—ì´ì „íŠ¸ ì¡°íšŒ ì‹œ revert
  
  3. ë¦¬ìŠ¤í¬ í‰ê°€ í…ŒìŠ¤íŠ¸
     - assessRisk() ì •ìƒ ë™ì‘
     - í”„ë¡œí† ì½œ íƒ€ì…ë³„ ê³„ì‚°
  
  4. ì´ë ¥ ì¡°íšŒ í…ŒìŠ¤íŠ¸
     - ì—¬ëŸ¬ ë²ˆ ì—…ë°ì´íŠ¸ í›„ ì´ë ¥ í™•ì¸
  
  5. ê°€ìŠ¤ ë²¤ì¹˜ë§ˆí¬
     - updateScore ê°€ìŠ¤ ì¸¡ì •
     - getScore vs getScoreOnly ë¹„êµ

deliverables:
  - contracts/test/AgentFICOScore.t.sol

acceptance_criteria:
  - [ ] ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼
  - [ ] forge test -vvv ì„±ê³µ
  - [ ] ê°€ìŠ¤ ë¦¬í¬íŠ¸ í™•ì¸
```

## Phase 2: Base Sepolia í…ŒìŠ¤íŠ¸ë„· ë°°í¬

### TASK-004: ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±
```yaml
task_id: M1-004
title: "Foundry ë°°í¬ ìŠ¤í¬ë¦½íŠ¸"
droid: web3-smart-contract-auditor
priority: high
depends_on: [M1-003]

instructions: |
  ## ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±
  script/Deploy.s.sol ì‘ì„±
  
  ## í™˜ê²½ ë³€ìˆ˜
  - PRIVATE_KEY: ë°°í¬ ì§€ê°‘ ê°œì¸í‚¤
  - RPC_URL: Base Sepolia/Mainnet RPC
  - ETHERSCAN_API_KEY: Basescan API í‚¤ (ê²€ì¦ìš©)
  
  ## ë°°í¬ ëª…ë ¹ì–´
  # Sepolia
  forge script script/Deploy.s.sol --rpc-url $BASE_SEPOLIA_RPC --broadcast --verify
  
  # Mainnet  
  forge script script/Deploy.s.sol --rpc-url $BASE_MAINNET_RPC --broadcast --verify

deliverables:
  - contracts/script/Deploy.s.sol
  - contracts/.env.example ì—…ë°ì´íŠ¸

acceptance_criteria:
  - [ ] ìŠ¤í¬ë¦½íŠ¸ ë¬¸ë²• ì˜¤ë¥˜ ì—†ìŒ
  - [ ] ì‹œë®¬ë ˆì´ì…˜ ì„±ê³µ (--dry-run)
```

### TASK-005: Base Sepolia ë°°í¬
```yaml
task_id: M1-005
title: "Base Sepolia í…ŒìŠ¤íŠ¸ë„· ë°°í¬"
droid: web3-smart-contract-auditor
priority: high
depends_on: [M1-004]

instructions: |
  ## ì‚¬ì „ ì¤€ë¹„
  1. MetaMaskì— Base Sepolia ë„¤íŠ¸ì›Œí¬ ì¶”ê°€
     - RPC: https://sepolia.base.org
     - Chain ID: 84532
     - Symbol: ETH
     - Explorer: https://sepolia.basescan.org
  
  2. Faucetì—ì„œ í…ŒìŠ¤íŠ¸ ETH ìˆ˜ë ¹
     - https://www.coinbase.com/faucets/base-ethereum-sepolia-faucet
  
  ## ë°°í¬ ì‹¤í–‰
  cd contracts
  source .env
  forge script script/Deploy.s.sol \
    --rpc-url https://sepolia.base.org \
    --broadcast \
    --verify
  
  ## ê²€ì¦
  1. ë°°í¬ëœ ì»¨íŠ¸ë™íŠ¸ ì£¼ì†Œ ê¸°ë¡
  2. Basescanì—ì„œ ì»¨íŠ¸ë™íŠ¸ í™•ì¸
  3. Read/Write í•¨ìˆ˜ í…ŒìŠ¤íŠ¸

deliverables:
  - ë°°í¬ëœ ì»¨íŠ¸ë™íŠ¸ ì£¼ì†Œ (Sepolia)
  - Basescan ê²€ì¦ ì™„ë£Œ
  - í…ŒìŠ¤íŠ¸ íŠ¸ëœì­ì…˜ í•´ì‹œ

acceptance_criteria:
  - [ ] ì»¨íŠ¸ë™íŠ¸ ë°°í¬ ì„±ê³µ
  - [ ] Basescanì—ì„œ verified
  - [ ] updateScore í…ŒìŠ¤íŠ¸ íŠ¸ëœì­ì…˜ ì„±ê³µ
  - [ ] getScore ì¡°íšŒ ì„±ê³µ
```

## Phase 3: Base Mainnet ë°°í¬

### TASK-006: Base Mainnet ë°°í¬
```yaml
task_id: M1-006
title: "Base Mainnet í”„ë¡œë•ì…˜ ë°°í¬"
droid: web3-smart-contract-auditor
priority: critical
depends_on: [M1-005]

instructions: |
  ## ì‚¬ì „ ì¤€ë¹„
  1. MetaMaskì— Base Mainnet ë„¤íŠ¸ì›Œí¬ í™•ì¸
     - RPC: https://mainnet.base.org
     - Chain ID: 8453
     - Symbol: ETH
     - Explorer: https://basescan.org
  
  2. ê°€ìŠ¤ë¹„ìš© í™•ì¸ (~$0.50-1.00 for deploy)
  
  ## ë°°í¬ ì‹¤í–‰
  cd contracts
  source .env
  forge script script/Deploy.s.sol \
    --rpc-url https://mainnet.base.org \
    --broadcast \
    --verify
  
  ## ë°°í¬ í›„ ì‘ì—…
  1. ì»¨íŠ¸ë™íŠ¸ ì£¼ì†Œ ë¬¸ì„œí™”
  2. Basescan ê²€ì¦ í™•ì¸
  3. ì´ˆê¸° ì—ì´ì „íŠ¸ ì ìˆ˜ ë“±ë¡ í…ŒìŠ¤íŠ¸
  4. techspec ì—…ë°ì´íŠ¸ (ì»¨íŠ¸ë™íŠ¸ ì£¼ì†Œ)

deliverables:
  - ë°°í¬ëœ ì»¨íŠ¸ë™íŠ¸ ì£¼ì†Œ (Mainnet)
  - Basescan ê²€ì¦ ì™„ë£Œ
  - docs/AGENTFICO_TECH_SPEC.md ì—…ë°ì´íŠ¸

acceptance_criteria:
  - [ ] ì»¨íŠ¸ë™íŠ¸ ë°°í¬ ì„±ê³µ
  - [ ] Basescanì—ì„œ verified
  - [ ] techspecì— ì»¨íŠ¸ë™íŠ¸ ì£¼ì†Œ ê¸°ë¡
```

### TASK-007: ë°°í¬ ë¬¸ì„œí™”
```yaml
task_id: M1-007
title: "ë°°í¬ ê²°ê³¼ ë¬¸ì„œí™”"
droid: web3-smart-contract-auditor
priority: medium
depends_on: [M1-006]

instructions: |
  ## ë¬¸ì„œ ì‘ì„±
  docs/DEPLOYMENT.md ì‘ì„±
  
  ## í¬í•¨ ë‚´ìš©
  1. ë„¤íŠ¸ì›Œí¬ ì •ë³´
  2. ì»¨íŠ¸ë™íŠ¸ ì£¼ì†Œ (Sepolia, Mainnet)
  3. ë°°í¬ íŠ¸ëœì­ì…˜ í•´ì‹œ
  4. ABI íŒŒì¼ ìœ„ì¹˜
  5. ì‚¬ìš© ë°©ë²• ì˜ˆì‹œ (ethers.js, viem)

deliverables:
  - docs/DEPLOYMENT.md
  - contracts/out/AgentFICOScore.sol/AgentFICOScore.json (ABI)

acceptance_criteria:
  - [ ] ëª¨ë“  ë°°í¬ ì •ë³´ ë¬¸ì„œí™”
  - [ ] ABI íŒŒì¼ ì ‘ê·¼ ê°€ëŠ¥
```

## Droid Assignment

| Task | Droid | Reason |
|:---|:---|:---|
| M1-000 | linear-project-manager | Linear ì´ìŠˆ ê´€ë¦¬ (web3 íŒ€) |
| M1-001 | web3-smart-contract-auditor | Foundry ì„¸íŒ… |
| M1-002 | web3-smart-contract-auditor | í•µì‹¬ ê³„ì•½ êµ¬í˜„ |
| M1-003 | web3-smart-contract-auditor | í…ŒìŠ¤íŠ¸ ì‘ì„± |
| M1-004 | web3-smart-contract-auditor | ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ |
| M1-005 | web3-smart-contract-auditor | Sepolia ë°°í¬ |
| M1-006 | web3-smart-contract-auditor | Mainnet ë°°í¬ |
| M1-007 | web3-smart-contract-auditor | ë¬¸ì„œí™” |

## Cost Estimate

| Item | Cost |
|:---|:---|
| Base Sepolia ë°°í¬ | Free (testnet) |
| Base Mainnet ë°°í¬ | ~$0.50-1.00 |
| ì›”ê°„ updateScore (600 agents) | ~$1-5 |

## Timeline

| Day | Tasks | Milestone |
|:---|:---|:---|
| Day 1 | M1-000 ~ M1-002 | Linear ë“±ë¡, Foundry ì„¸íŒ…, ê³„ì•½ êµ¬í˜„ |
| Day 2 | M1-003 ~ M1-005 | í…ŒìŠ¤íŠ¸, ë°°í¬ ìŠ¤í¬ë¦½íŠ¸, Sepolia ë°°í¬ |
| Day 3 | M1-006 ~ M1-007 | Mainnet ë°°í¬, ë¬¸ì„œí™” |

## Success Criteria

- [ ] Foundry í”„ë¡œì íŠ¸ ì •ìƒ ë¹Œë“œ
- [ ] ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼
- [ ] Base Sepolia ë°°í¬ ë° ê²€ì¦ ì™„ë£Œ
- [ ] Base Mainnet ë°°í¬ ë° ê²€ì¦ ì™„ë£Œ
- [ ] ì»¨íŠ¸ë™íŠ¸ ì£¼ì†Œ techspecì— ê¸°ë¡
- [ ] ëª¨ë“  Linear ì´ìŠˆ Done

## References

- [Base Documentation](https://docs.base.org)
- [Foundry Book](https://book.getfoundry.sh)
- [Basescan](https://basescan.org)
- [docs/AGENTFICO_TECH_SPEC.md](../../../AGENTFICO_TECH_SPEC.md)
