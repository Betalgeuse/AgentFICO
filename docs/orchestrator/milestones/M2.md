# AgentFICO - Milestone M2: Score Calculation Engine

## Overview
| Field | Value |
|:---|:---|
| **Milestone ID** | M2-score-calculation |
| **Title** | Score Calculation Engine |
| **Status** | ğŸš€ In Progress |
| **Start Date** | 2026-01-29 |
| **Target Date** | 2026-02-07 |
| **Priority** | **HIGH** (M1 ì„ í–‰ ì¡°ê±´) |
| **Linear Label** | `milestone:M2` |
| **Linear Team** | `web3` |

## Why M2 First?
> ì°¸ì¡°: [ADR-002](../../adr/ADR-002-deployment-order.md)
> 
> ì˜¨ì²´ì¸ ì»¨íŠ¸ë™íŠ¸ëŠ” ìˆ˜ì • ë¶ˆê°€. ì ìˆ˜ ê³µì‹ì„ ì¶©ë¶„íˆ ê²€ì¦í•œ í›„ ë°°í¬í•´ì•¼ ì‹ ë¢° ìœ ì§€.

## Goals
- ì ìˆ˜ ê³„ì‚° ë¡œì§ êµ¬í˜„ ë° ê²€ì¦
- ë°ì´í„° ì†ŒìŠ¤ ì—°ë™ (Etherscan API)
- ì‹¤ì œ ì—ì´ì „íŠ¸ ë°ì´í„°ë¡œ ë°±í…ŒìŠ¤íŠ¸
- ì ìˆ˜ ê³µì‹ í™•ì • (40-40-20 ê°€ì¤‘ì¹˜ ê²€ì¦)

## Non-Goals
- ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ ë°°í¬ (M1, ì´ ë§ˆì¼ìŠ¤í†¤ ì™„ë£Œ í›„)
- DeFi í”„ë¡œí† ì½œ í†µí•© (M3)
- í”„ë¡ íŠ¸ì—”ë“œ ëŒ€ì‹œë³´ë“œ (M4)

## Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Score Calculation Engine                     â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Etherscan API    â”‚  â”‚ x402 Protocol    â”‚  â”‚ ERC-8004      â”‚â”‚
â”‚  â”‚ (txSuccess)      â”‚  â”‚ (profitability)  â”‚  â”‚ (stability)   â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚           â”‚                     â”‚                     â”‚        â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                         â–¼                                       â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚           â”‚    Score Calculator         â”‚                      â”‚
â”‚           â”‚  â€¢ txSuccess (40%)          â”‚                      â”‚
â”‚           â”‚  â€¢ x402Profitability (40%)  â”‚                      â”‚
â”‚           â”‚  â€¢ erc8004Stability (20%)   â”‚                      â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                          â–¼                                      â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚           â”‚    AgentFICO Score (0-1000) â”‚                      â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Phase 0: Linear ì´ìŠˆ ë“±ë¡

### TASK-000: Linear í”„ë¡œì íŠ¸ ì´ˆê¸°í™”
```yaml
task_id: M2-000
title: "Linear ì´ìŠˆ ë“±ë¡"
droid: linear-project-manager
priority: critical
depends_on: []
team: web3

instructions: |
  1. Linear web3 íŒ€ì— M2 ì´ìŠˆ ë“±ë¡
  2. Label ìƒì„±:
     - milestone:M2
     - phase:0, phase:1, phase:2, phase:3
     - type:api, type:data, type:test
  3. ëª¨ë“  TASKë¥¼ Linear Issueë¡œ ë“±ë¡
  4. ì˜ì¡´ì„± ì„¤ì •

deliverables:
  - Linearì— ëª¨ë“  ì´ìŠˆ ë“±ë¡ ì™„ë£Œ
  - ê° TASKì— linear_issue_id ì¶”ê°€
```

## Phase 1: ë°ì´í„° ì†ŒìŠ¤ ì—°ë™

### TASK-001: Etherscan API ì—°ë™
```yaml
task_id: M2-001
title: "Etherscan API í´ë¼ì´ì–¸íŠ¸ êµ¬í˜„"
droid: web3-api-developer
priority: critical
depends_on: []

instructions: |
  ## ëª©í‘œ
  ì—ì´ì „íŠ¸ì˜ íŠ¸ëœì­ì…˜ ì„±ê³µë¥ (txSuccess) ë°ì´í„° ìˆ˜ì§‘
  
  ## êµ¬í˜„ ë‚´ìš©
  1. Etherscan API í´ë¼ì´ì–¸íŠ¸ í´ë˜ìŠ¤
  2. ì—ì´ì „íŠ¸ ì£¼ì†Œë³„ íŠ¸ëœì­ì…˜ íˆìŠ¤í† ë¦¬ ì¡°íšŒ
  3. íŠ¸ëœì­ì…˜ ì„±ê³µ/ì‹¤íŒ¨ ë¶„ì„
  4. Rate limiting ì²˜ë¦¬ (5 calls/sec)
  
  ## API ì—”ë“œí¬ì¸íŠ¸
  - txlist: ì¼ë°˜ íŠ¸ëœì­ì…˜
  - txlistinternal: ë‚´ë¶€ íŠ¸ëœì­ì…˜
  - tokentx: ERC-20 ì „ì†¡
  
  ## ë””ë ‰í† ë¦¬ êµ¬ì¡°
  api/
  â”œâ”€â”€ src/
  â”‚   â”œâ”€â”€ data_sources/
  â”‚   â”‚   â””â”€â”€ etherscan.py
  â”‚   â””â”€â”€ models/
  â”‚       â””â”€â”€ transaction.py

deliverables:
  - api/src/data_sources/etherscan.py
  - api/src/models/transaction.py
  - ë‹¨ìœ„ í…ŒìŠ¤íŠ¸

acceptance_criteria:
  - [ ] API í˜¸ì¶œ ì„±ê³µ
  - [ ] íŠ¸ëœì­ì…˜ ì„±ê³µë¥  ê³„ì‚° ì •í™•
  - [ ] Rate limiting ë™ì‘
```

### TASK-002: x402 Protocol ë°ì´í„° ì—°ë™
```yaml
task_id: M2-002
title: "x402 Protocol ìˆ˜ìµì„± ë°ì´í„°"
droid: web3-api-developer
priority: high
depends_on: [M2-001]

instructions: |
  ## ëª©í‘œ
  ì—ì´ì „íŠ¸ì˜ x402 í”„ë¡œí† ì½œ ìˆ˜ìµì„±(profitability) ë°ì´í„° ìˆ˜ì§‘
  
  ## êµ¬í˜„ ë‚´ìš©
  1. x402 Payment ì´ë²¤íŠ¸ ì¡°íšŒ
  2. ì—ì´ì „íŠ¸ë³„ ìˆ˜ìµ/ì§€ì¶œ ë¶„ì„
  3. ROI ê³„ì‚° ë¡œì§
  
  ## ë°ì´í„° ì†ŒìŠ¤
  - ì˜¨ì²´ì¸ ì´ë²¤íŠ¸ ë¡œê·¸
  - x402 ê²°ì œ ì»¨íŠ¸ë™íŠ¸

deliverables:
  - api/src/data_sources/x402.py
  - ìˆ˜ìµì„± ê³„ì‚° ë¡œì§

acceptance_criteria:
  - [ ] x402 ì´ë²¤íŠ¸ íŒŒì‹± ì„±ê³µ
  - [ ] ìˆ˜ìµì„± ì§€í‘œ ê³„ì‚°
```

### TASK-003: ERC-8004 ì•ˆì •ì„± ì§€í‘œ (ëª¨í‚¹)
```yaml
task_id: M2-003
title: "ERC-8004 ì•ˆì •ì„± ì§€í‘œ"
droid: web3-api-developer
priority: medium
depends_on: []

instructions: |
  ## ëª©í‘œ
  ì—ì´ì „íŠ¸ì˜ ERC-8004 ê¸°ë°˜ ì•ˆì •ì„± ì§€í‘œ ê³„ì‚°
  
  ## í˜„ì¬ ìƒíƒœ
  ERC-8004 í‘œì¤€ ë¯¸í™•ì •ìœ¼ë¡œ ëª¨í‚¹ ë°ì´í„° ì‚¬ìš©
  
  ## êµ¬í˜„ ë‚´ìš©
  1. ì•ˆì •ì„± ì§€í‘œ ì¸í„°í˜ì´ìŠ¤ ì •ì˜
  2. ëª¨í‚¹ ë°ì´í„° ìƒì„±ê¸°
  3. ì‹¤ì œ ë°ì´í„° ì—°ë™ ì‹œ êµì²´ ê°€ëŠ¥í•œ êµ¬ì¡°

deliverables:
  - api/src/data_sources/erc8004.py
  - api/src/data_sources/erc8004_mock.py

acceptance_criteria:
  - [ ] ì¸í„°í˜ì´ìŠ¤ ì •ì˜
  - [ ] ëª¨í‚¹ ë°ì´í„° ìƒì„±
```

## Phase 2: ì ìˆ˜ ê³„ì‚° ì—”ì§„

### TASK-004: Score Calculator êµ¬í˜„
```yaml
task_id: M2-004
title: "ì ìˆ˜ ê³„ì‚° ì—”ì§„ í•µì‹¬ ë¡œì§"
droid: web3-api-developer
priority: critical
depends_on: [M2-001, M2-002, M2-003]

instructions: |
  ## ëª©í‘œ
  AgentFICO ì ìˆ˜ ê³„ì‚° ë¡œì§ êµ¬í˜„
  
  ## ê³„ì‚° ê³µì‹ (ê²€ì¦ í•„ìš”)
  overall = txSuccess * 0.4 + x402Profitability * 0.4 + erc8004Stability * 0.2
  
  ## ì…ë ¥ê°’ (ê° 0-100)
  - txSuccess: íŠ¸ëœì­ì…˜ ì„±ê³µë¥ 
  - x402Profitability: ìˆ˜ìµì„± ì§€í‘œ
  - erc8004Stability: ì•ˆì •ì„± ì§€í‘œ
  
  ## ì¶œë ¥ê°’
  - overall: 0-1000 (ì…ë ¥ê°’ * 10)
  - riskLevel: 1-5
  - confidence: 0-100
  
  ## ë¦¬ìŠ¤í¬ ë ˆë²¨ ë§¤í•‘
  1: Excellent (850+)
  2: Good (750-849)
  3: Average (650-749)
  4: Below Average (550-649)
  5: Poor (<550)

deliverables:
  - api/src/calculator/score_calculator.py
  - ë‹¨ìœ„ í…ŒìŠ¤íŠ¸

acceptance_criteria:
  - [ ] ì ìˆ˜ ê³„ì‚° ì •í™•
  - [ ] ë¦¬ìŠ¤í¬ ë ˆë²¨ ë§¤í•‘ ì •í™•
  - [ ] ì—£ì§€ ì¼€ì´ìŠ¤ ì²˜ë¦¬
```

### TASK-005: ë°±í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬
```yaml
task_id: M2-005
title: "ì ìˆ˜ ê³µì‹ ë°±í…ŒìŠ¤íŠ¸"
droid: blockchain-data-analyzer
priority: high
depends_on: [M2-004]

instructions: |
  ## ëª©í‘œ
  ì‹¤ì œ ì—ì´ì „íŠ¸ ë°ì´í„°ë¡œ ì ìˆ˜ ê³µì‹ ê²€ì¦
  
  ## ë°±í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤
  1. ì•Œë ¤ì§„ "ì¢‹ì€" ì—ì´ì „íŠ¸ â†’ ë†’ì€ ì ìˆ˜?
  2. ì•Œë ¤ì§„ "ë‚˜ìœ" ì—ì´ì „íŠ¸ â†’ ë‚®ì€ ì ìˆ˜?
  3. ê°€ì¤‘ì¹˜ ë³€ê²½ ì‹œ ë¶„í¬ ë³€í™”
  
  ## í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…‹
  - ìµœì†Œ 10ê°œ ì—ì´ì „íŠ¸ ì£¼ì†Œ
  - ë‹¤ì–‘í•œ í™œë™ íŒ¨í„´ í¬í•¨
  
  ## ì¶œë ¥
  - ì ìˆ˜ ë¶„í¬ íˆìŠ¤í† ê·¸ë¨
  - ê°€ì¤‘ì¹˜ë³„ ë¯¼ê°ë„ ë¶„ì„

deliverables:
  - api/src/backtest/backtest_runner.py
  - ë°±í…ŒìŠ¤íŠ¸ ê²°ê³¼ ë¦¬í¬íŠ¸

acceptance_criteria:
  - [ ] ì ìˆ˜ ë¶„í¬ í•©ë¦¬ì 
  - [ ] ê°€ì¤‘ì¹˜ ë¯¼ê°ë„ ë¬¸ì„œí™”
```

## Phase 3: REST API

### TASK-006: FastAPI ì—”ë“œí¬ì¸íŠ¸
```yaml
task_id: M2-006
title: "Score API ì—”ë“œí¬ì¸íŠ¸"
droid: web3-api-developer
priority: high
depends_on: [M2-004]

instructions: |
  ## ëª©í‘œ
  ì ìˆ˜ ì¡°íšŒ REST API êµ¬í˜„
  
  ## ì—”ë“œí¬ì¸íŠ¸
  GET /score/{agent_address}
  - ì—ì´ì „íŠ¸ ì ìˆ˜ ì¡°íšŒ
  - ì‘ë‹µ: Score ê°ì²´
  
  GET /score/{agent_address}/history
  - ì ìˆ˜ ì´ë ¥ ì¡°íšŒ
  
  POST /score/{agent_address}/refresh
  - ì ìˆ˜ ì¬ê³„ì‚° íŠ¸ë¦¬ê±°
  
  ## ì‘ë‹µ í˜•ì‹
  {
    "overall": 780,
    "txSuccess": 85,
    "x402Profitability": 72,
    "erc8004Stability": 68,
    "riskLevel": 2,
    "confidence": 95,
    "timestamp": "2026-01-29T12:00:00Z"
  }

deliverables:
  - api/src/routes/score.py
  - OpenAPI ë¬¸ì„œ

acceptance_criteria:
  - [ ] ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸ ë™ì‘
  - [ ] ì—ëŸ¬ í•¸ë“¤ë§
  - [ ] API ë¬¸ì„œí™”
```

### TASK-007: ì ìˆ˜ ê³µì‹ í™•ì • ë° ë¬¸ì„œí™”
```yaml
task_id: M2-007
title: "ì ìˆ˜ ê³µì‹ í™•ì •"
droid: blockchain-data-analyzer
priority: critical
depends_on: [M2-005, M2-006]

instructions: |
  ## ëª©í‘œ
  ë°±í…ŒìŠ¤íŠ¸ ê²°ê³¼ ê¸°ë°˜ ìµœì¢… ì ìˆ˜ ê³µì‹ í™•ì •
  
  ## ì‘ì—… ë‚´ìš©
  1. ë°±í…ŒìŠ¤íŠ¸ ê²°ê³¼ ë¶„ì„
  2. ê°€ì¤‘ì¹˜ ìµœì í™” (í•„ìš”ì‹œ)
  3. ADR ì‘ì„±: ì ìˆ˜ ê³µì‹ ê²°ì • ê·¼ê±°
  4. TECH_SPEC ì—…ë°ì´íŠ¸
  
  ## ê²°ì • ì‚¬í•­
  - ìµœì¢… ê°€ì¤‘ì¹˜ (í˜„ì¬ 40-40-20)
  - ë¦¬ìŠ¤í¬ ë ˆë²¨ threshold
  - confidence ê³„ì‚° ë°©ì‹

deliverables:
  - docs/adr/ADR-003-score-formula.md
  - docs/AGENTFICO_TECH_SPEC.md ì—…ë°ì´íŠ¸

acceptance_criteria:
  - [ ] ì ìˆ˜ ê³µì‹ í™•ì •
  - [ ] ADR ë¬¸ì„œí™”
  - [ ] M1 ì¬ê°œ ì¡°ê±´ ì¶©ì¡±
```

## Droid Assignment

| Task | Droid | Reason |
|:---|:---|:---|
| M2-000 | linear-project-manager | Linear ì´ìŠˆ ê´€ë¦¬ |
| M2-001 | web3-api-developer | Etherscan API ì—°ë™ |
| M2-002 | web3-api-developer | x402 ë°ì´í„° ì—°ë™ |
| M2-003 | web3-api-developer | ERC-8004 ì¸í„°í˜ì´ìŠ¤ |
| M2-004 | web3-api-developer | ì ìˆ˜ ê³„ì‚° ì—”ì§„ |
| M2-005 | blockchain-data-analyzer | ë°±í…ŒìŠ¤íŠ¸ ë¶„ì„ |
| M2-006 | web3-api-developer | REST API êµ¬í˜„ |
| M2-007 | blockchain-data-analyzer | ê³µì‹ í™•ì • |

## Cost Estimate

| Item | Cost |
|:---|:---|
| Etherscan API | Free tier (5 calls/sec) |
| ì„œë²„ ìš´ì˜ | ~$20/month (AWS t3.small) |
| ê°œë°œ ê¸°ê°„ | 7-10ì¼ |

## Timeline

| Day | Tasks | Milestone |
|:---|:---|:---|
| Day 1-2 | M2-000 ~ M2-003 | ë°ì´í„° ì†ŒìŠ¤ ì—°ë™ |
| Day 3-4 | M2-004 ~ M2-005 | ì ìˆ˜ ê³„ì‚° + ë°±í…ŒìŠ¤íŠ¸ |
| Day 5-7 | M2-006 ~ M2-007 | API + ê³µì‹ í™•ì • |

## Success Criteria

- [ ] ëª¨ë“  ë°ì´í„° ì†ŒìŠ¤ ì—°ë™
- [ ] ì ìˆ˜ ê³„ì‚° ë¡œì§ êµ¬í˜„
- [ ] ë°±í…ŒìŠ¤íŠ¸ í†µê³¼
- [ ] ì ìˆ˜ ê³µì‹ í™•ì • (ADR)
- [ ] REST API ë™ì‘
- [ ] **M1 ì¬ê°œ ì¡°ê±´ ì¶©ì¡±**

## M1 ì¬ê°œ ì¡°ê±´

M2 ì™„ë£Œ í›„ M1 (ì˜¨ì²´ì¸ ë°°í¬) ì¬ê°œ ì¡°ê±´:
1. âœ… ì ìˆ˜ ê³µì‹ í™•ì • (ADR-003)
2. âœ… ë°±í…ŒìŠ¤íŠ¸ í†µê³¼ (í•©ë¦¬ì  ì ìˆ˜ ë¶„í¬)
3. âœ… APIë¡œ ì ìˆ˜ ì¡°íšŒ ê°€ëŠ¥
4. âœ… íŒ€ ë¦¬ë·° ì™„ë£Œ

## References

- [ADR-002](../../adr/ADR-002-deployment-order.md) - M2 ìš°ì„  ê°œë°œ ê²°ì •
- [AGENTFICO_TECH_SPEC](../../business-context/specs/AGENTFICO_TECH_SPEC.md) - ê¸°ìˆ  ëª…ì„¸
- [Etherscan API Docs](https://docs.etherscan.io)
